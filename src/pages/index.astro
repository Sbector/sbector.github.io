---
import Layout from "@/layouts/Layout.astro";
import { getCollection } from "astro:content";

const obras = (await getCollection("obras"))
  .filter((obra) => obra.data.status === "published")
  .sort((a, b) => b.data.year - a.data.year);
---

<Layout>
  <div
    class="
      w-full
      grid
      grid-cols-1
      sm:grid-cols-2
      lg:grid-cols-3
      auto-rows-[320px]
      gap-6
      px-6
      md:px-12
      py-12
      grid-flow-dense
    "
  >
    {
      obras.map((obra) => (
        <a
          href={`/obras/${obra.data.slug}`}
          class={`
            group
            overflow-hidden
            relative
            ${obra.data.bento === "wide" ? "lg:col-span-2" : ""}
            ${obra.data.bento === "tall" ? "lg:row-span-2" : ""}
            ${obra.data.bento === "large" ? "lg:col-span-2 lg:row-span-2" : ""}
          `}
        >
          <img
            src={obra.data.cover.src}
            alt={obra.data.cover.alt}
            loading="lazy"
            class="
              w-full
              h-full
              object-cover
              transition-transform
              duration-700
              ease-out
              group-hover:scale-[1.03]
            "
          />

          <!-- Overlay editorial -->
          <div
            class="
              absolute
              inset-0
              bg-black/0
              group-hover:bg-black/30
              transition-colors
              duration-500
            "
          />

          <div
            class="
              absolute
              bottom-4
              left-4
              text-white
              opacity-0
              group-hover:opacity-100
              transition-opacity
              duration-500
            "
          >
            <h3 class="text-sm tracking-wide uppercase">
              {obra.data.title}
            </h3>
            <p class="text-xs opacity-80">
              {obra.data.year}
            </p>
          </div>
        </a>
      ))
    }
  </div>
</Layout>