---
import Layout from "@/layouts/Layout.astro";
import { getCollection } from "astro:content";
import type { CollectionEntry } from "astro:content";

type Obra = CollectionEntry<"obras">;

export async function getStaticPaths() {
  const obras = await getCollection("obras");

  return obras
    .filter((obra) => obra.data.status === "published")
    .map((obra) => ({
      params: { slug: obra.data.slug },
      props: { obra },
    }));
}

const { obra } = Astro.props as { obra: Obra };
---

<Layout title={`${obra.data.title} | sbector`}>
  <!-- PRIMERA VISTA -->
  <section class="max-h-[calc(100vh-2.5rem)] flex flex-col lg:flex-row">
    <!-- Imagen -->
    <div class="flex-1 flex items-center justify-center bg-neutral-950">
      <img
        transition:name={`img-${obra.data.slug}`}
        src={obra.data.cover.src}
        alt={obra.data.cover.alt}
        class="max-h-full w-auto object-contain"
        loading="eager"
      />
    </div>

    <!-- Ficha -->
    <div class="w-full lg:w-105 flex items-center">
      <div class="px-8 py-12">
        <h1 class="text-xl md:text-2xl uppercase tracking-wide">
          {obra.data.title}
        </h1>

        <p class="mt-2 text-sm text-neutral-400">
          {obra.data.year}
        </p>

        {
          obra.data.description && (
            <p class="mt-6 text-sm text-neutral-300 leading-relaxed">
              {obra.data.description}
            </p>
          )
        }
      </div>
    </div>
  </section>

  <!-- CONTENIDO -->
  {
    obra.body && (
      <section class="max-w-3xl mx-auto px-6 md:px-10 py-24">
        <div class="prose prose-invert max-w-none">{obra.body}</div>
      </section>
    )
  }
</Layout>
